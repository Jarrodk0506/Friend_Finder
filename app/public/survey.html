<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <title>Friend Finder</title>
</head>

<body>
    <div class="container-fluid">
        <h1>Survey Questions</h1>
        <br>
        <form>
            <h2>About you</h2>
            <div class="form-group">
                <label for="name">Name (Required)</label>
                <input type="email" class="form-control" id="name" placeholder="Enter Name">
            </div>
            <div class="form-group">
                <label for="photo">Link to Photo Image (Required)</label>
                <input type="link" class="form-control" id="photo" placeholder="Photo Link">
            </div>
            <br>
            <br>
            <div>
                <h3>Question 1</h3>
                <h4>Which would you prefer?</h4>
                <select id="q1" class="form-control form-control-sm col-sm-2">
                    <option>Scenic mountains</option>
                    <option>Sandy beaches</option>
                    <option>Snowy ski slopes</option>
                    <option>A crowded city</option>
                    <option>A Forest</option>
                </select>
            </div>
            <br>
            <div>
                <h3>Question 2</h3>
                <h4>What is your favorite element?</h4>
                <select id="q2" class="form-control form-control-sm col-sm-2">
                    <option>Fire</option>
                    <option>Water</option>
                    <option>Earth</option>
                    <option>Air</option>
                    <option>Electricity</option>
                </select>
            </div>
            <br>
            <div>
                <h3>Question 3</h3>
                <h4>In an emergency you would...</h4>
                <select id="q3" class="form-control form-control-sm col-sm-2">
                    <option>Run and get help</option>
                    <option>Faint</option>
                    <option>Try to be  hero</option>
                    <option>Do nothing</option>
                    <option>Cry</option>
                </select>
            </div>
            <br>
            <div>
                <h3>Question 4</h3>
                <h4>Favorite color?</h4>
                <select id="q4" class="form-control form-control-sm col-sm-2">
                    <option>Red</option>
                    <option>Blue</option>
                    <option>Green</option>
                    <option>Yellow</option>
                    <option>Purple</option>
                </select>
            </div>
            <br>
            <div>
                <h3>Question 5</h3>
                <h4>Favorite type of car?</h4>
                <select id="q5" class="form-control form-control-sm col-sm-2">
                    <option>Honda</option>
                    <option>Toyota</option>
                    <option>Nissan</option>
                    <option>Chevrolet</option>
                    <option>Ford</option>
                </select>
            </div>
            <br>
            <div>
                <h3>Question 6</h3>
                <h4>Pick one of the following.</h4>
                <select id="q6" class="form-control form-control-sm col-sm-2">
                    <option>Go to a bar</option>
                    <option>Go to a nightclub</option>
                    <option>Go to a comedy club</option>
                    <option>Go to a concert</option>
                    <option>Go to bed</option>
                </select>
            </div>
            <br>
            <div>
                <h3>Question 7</h3>
                <h4>Pick a show</h4>
                <select id="q7" class="form-control form-control-sm col-sm-2">
                    <option>Friends</option>
                    <option>The Office</option>
                    <option>The Simpsons</option>
                    <option>Family Guy</option>
                    <option>SouthPark</option>
                </select>
            </div>
            <br>
            <div>
                <h3>Question 8</h3>
                <h4>Pick a drink</h4>
                <select id="q8" class="form-control form-control-sm col-sm-2">
                    <option>Moscow Mule</option>
                    <option>Long Island Iced Tea</option>
                    <option>Rum & Coke</option>
                    <option>Scotch on the Rocks</option>
                    <option>Mimosa</option>
                </select>
            </div>
            <br>
            <div>
                <h3>Question 9</h3>
                <h4>Pick a super power</h4>
                <select id="q9" class="form-control form-control-sm col-sm-2">
                    <option>Flight</option>
                    <option>Super Speed</option>
                    <option>Time Control</option>
                    <option>Invisibility</option>
                    <option>Super Strength</option>
                </select>
            </div>
            <br>
            <div>
                <h3>Question 10</h3>
                <h4>pick a meal</h4>
                <select id="q10" class="form-control form-control-sm col-sm-2">
                    <option>Burger and Fries</option>
                    <option>Fish and Chips</option>
                    <option>Filet Mignon and a Baked Potato</option>
                    <option>Soup and Salad</option>
                    <option>Tacos</option>
                </select>
            </div>
            <br>
            <button type="button" id="submit" class="btn btn-primary btn-lg btn-block">Submit</button>

        </form>
        <br><br>
        <p><a href="/api/friends">Friend List Api</a> || <a
                href="https://github.com/Jarrodk0506/Friend_Finder.git">Github Repo</a></p>


        <div id="myModal" class="modal">

            <!-- Modal content -->
            <div class="modal-content">
                <span class="close">&times;</span>
                <p id="friendName"></p>
                <img id="friendPic" src=""
                    alt="Person Picture">
            </div>

        </div>


    </div>

    <script type="text/javascript">

        //capture modal and span to open and close modal
        var modal = document.getElementById("myModal");
        var span = document.getElementsByClassName("close")[0];
        span.onclick = function () {
            modal.style.display = "none";
        }

        $("#submit").on("click", function (event) {
            event.preventDefault();


            var newFriend = {
                name: $("#name").val().trim(),
                link: $("#photo").val().trim(),
                scores: [
                    $("#q1").val(),
                    $("#q2").val(),
                    $("#q3").val(),
                    $("#q4").val(),
                    $("#q5").val(),
                    $("#q6").val(),
                    $("#q7").val(),
                    $("#q8").val(),
                    $("#q9").val(),
                    $("#q10").val(),
                ]
            };


            $.get("/api/friends")
                .then(function (data) {

                    var comp = [100];
                    var match = "";
                    var pic = "";

                    for (var i = 0; i < data.length; i++) {

                        var newFriendScore = newFriend.scores;
                        var compareFriendScore = data[i].scores;
                        var totalDifference = 0;

                        for (var b = 0; b < compareFriendScore.length; b++) {
                            if (compareFriendScore[b] > parseFloat(newFriendScore[b])) {
                                totalDifference += parseFloat(compareFriendScore[b]) - parseFloat(newFriendScore[b]);
                            } else {
                                totalDifference += parseFloat(newFriendScore[b]) - parseFloat(compareFriendScore[b]);
                            }
                        };
                        

                        if (totalDifference < comp) {
                            comp.splice([0]);
                            comp.push(totalDifference);
                            match = data[i].name;
                            pic = data[i].link;
                        }

                    };

                    $.post("/api/friends", newFriend)
                    $("#friendName").append(match + " Is Your best friend!");
                    $("#friendPic").attr("src", pic);
                    modal.style.display = "block";

                });
                

        });

    </script>

</body>

</html>